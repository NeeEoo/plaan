"use strict";!function(){var r=document.getElementById("main").style.getPropertyValue("--rows"),e=document.getElementById("plan"),s=(document.getElementById("settings"),document.querySelector("[download]")),t=document.querySelector('[type="file"]'),n=document.querySelector('[type="reset"]');document.addEventListener("DOMContentLoaded",function(){localStorage.length&&(s.href="data:text/json,"+JSON.stringify(localStorage))}),e.querySelectorAll('[type="number"]').forEach(function(e){var n=e.closest("li"),a=e.dataset.key,o=function(e){return e.getAttribute("max")===r?"y":"x"}(e),t=localStorage.getItem(a),c={name:n.querySelector("h2").textContent};null!==t&&void 0!==(c=JSON.parse(t))[o]&&(n.style.setProperty("--".concat(o),c[o]),e.value=c[o]),e.addEventListener("change",function(e){var t=e.target.value;c[o]=t,n.style.setProperty("--".concat(o),t),localStorage.setItem(a,JSON.stringify(c)),s.href="data:text/json,"+JSON.stringify(localStorage)},!1)}),e.querySelectorAll("[data-step]").forEach(function(e){var t=e.dataset.controls,n=e.dataset.step,a=document.getElementById(t),o=new Event("change",{bubbles:!0});e.addEventListener("click",function(){switch(n){case"up":a.stepUp(1),a.dispatchEvent(o);break;case"down":a.stepDown(1),a.dispatchEvent(o);break;default:console.warn("".concat(e.textContent," value for data-step matches nothing…"))}},!1)}),e.querySelectorAll(".arrows").forEach(function(e){var t=e.dataset.controls,n=new Event("change",{bubbles:!0}),a=document.getElementById("".concat(t,"-y")),o=document.getElementById("".concat(t,"-x"));e.addEventListener("keydown",function(e){switch(e.keyCode){case 9:case 16:break;case 37:o.stepDown(1),o.dispatchEvent(n);break;case 38:a.stepDown(1),a.dispatchEvent(n);break;case 39:o.stepUp(1),o.dispatchEvent(n);break;case 40:a.stepUp(1),a.dispatchEvent(n);break;default:console.warn("".concat(e.keyCode," can't move ").concat(t,"…"))}},!1)}),t.addEventListener("change",function(e){var t=e.target.files[0],n=new FileReader;n.onload=function(e){JSON.parse(e.target.result,function(e,t){var n=JSON.parse(t);if(localStorage.removeItem(e),""!==e){var a=document.querySelector('[data-controls="'.concat(e,'"]')),o=document.getElementById("".concat(e,"-y")),c=document.getElementById("".concat(e,"-x")),r=a.closest("li");void 0!==n.y&&(r.style.setProperty("--y",n.y),o.value=n.y),void 0!==n.x&&(r.style.setProperty("--x",n.x),c.value=n.x)}localStorage.setItem(e,t)})},n.readAsText(t)}),n.addEventListener("click",function(){localStorage.clear()})}();